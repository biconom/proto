# Сервис: AccountService

## 1. Описание

**`AccountService`** — это клиентский сервис, который предоставляет текущему аутентифицированному пользователю полную, агрегированную информацию о его аккаунте и всех связанных с ним сущностях (дистрибьюторы, настройки безопасности, профиль и т.д.).

## 2. Описание методов (RPC)

### `rpc GetCurrent(GetCurrentRequest) returns (AccountView)`
- **Назначение**: Получить единую, агрегированную сводку по текущему (авторизованному) аккаунту.
- **Параметры `GetCurrentRequest`**:
  - `optional uint32 distributor_upline_visibility_depth`: Позволяет контролировать, на какую глубину вверх по иерархии будет возвращен список вышестоящих для каждого дистрибьютора в ответе.
- **Ответ `AccountView`**: Возвращает богатое представление `AccountView`, содержащее полную информацию об аккаунте и его активах.

## 3. Структура ответа `AccountView`

Ответ `AccountView` спроектирован так, чтобы предоставить клиенту максимум информации за один запрос.

- `executor_account_id`: ID аккаунта, под которым авторизован пользователь и от имени которого выполняется запрос. Позволяет клиенту понять, "кто я".
- `accounts`: Дедуплицированный список аккаунтов. Включает в себя аккаунт исполнителя (`executor_account_id`) и аккаунты-владельцы всех дистрибьюторов, упомянутых в поле `distributors` (как самих дистрибьюторов, так и их вышестоящих).
- `distributors`: Список дистрибьюторов, которыми владеет `executor_account_id`. Каждый элемент списка содержит:
  - `value`: Сам объект дистрибьютора.
  - `upline_distributors`: Список его вышестоящих дистрибьюторов, глубина которого контролируется параметром `distributor_upline_visibility_depth` в запросе.

### Профиль (`oneof profile`)

Поле `profile` содержит информацию, специфичную для типа владельца аккаунта (`User` или `Community`).

#### `UserProfile` (если владелец - пользователь)
Содержит детальную информацию о настройках пользователя:
- `email`: Email пользователя и дата его установки.
- `password`: ID политики пароля и дата его последней смены.
- `mnemonic`: Состояние мнемонической фразы.
- `google_authenticator`: Состояние двухфакторной аутентификации.
- `payment_details_registry`: Реестр сохраненных платежных реквизитов.
- `locale_id`: ID текущей локали пользователя.
- `telegram`: Информация о привязанном аккаунте Telegram.

#### `community_profile` (если владелец - сообщество)
На данный момент не содержит дополнительных полей, но зарезервировано для будущего расширения.