syntax = "proto3";

package biconom.client.marketing;

import "biconom/types/slot.proto";
import "biconom/types/subscription.proto";
import "biconom/types/marketing_slot.proto";
import "google/protobuf/empty.proto";

// MarketingService предоставляет функционал для управления аффилейт маркетингом,
// включая работу со слотами, подписками и расширением структуры.
service MarketingService {
    // Получить список состояний всех собственных слотов.
    rpc ListOwnSlotStates(google.protobuf.Empty) returns (biconom.types.MarketingSlot.State.List);

    // Получить детальную информацию о выбранном слоте.
    rpc GetSlot(biconom.types.Slot.Id) returns (biconom.types.MarketingSlot);

    // Работа с тарифными планами подписки
    rpc ListSubscriptionPlans(google.protobuf.Empty) returns (biconom.types.Subscription);
    rpc PurchaseSubscriptionPlan(PurchaseSubscriptionPlanRequest) returns (biconom.types.MarketingSlot);
    
    // Управление автопродлением подписки
    rpc DeactivateAutoRenewal(google.protobuf.Empty) returns (biconom.types.MarketingSlot.State);
    rpc RestoreAutoRenewal(google.protobuf.Empty) returns (biconom.types.MarketingSlot.State);
}

message PurchaseSubscriptionPlanRequest {
    uint32 plan_id = 1; // Идентификатор плана внутри системной лицензии маркетинга
    bool is_trial = 2; // Флаг приобретения пробного периода
}
