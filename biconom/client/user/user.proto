syntax = "proto3";

package biconom.client.user;

import "google/protobuf/empty.proto";
import "google/protobuf/timestamp.proto";
import "biconom/types/google_authenticator.proto";
import "biconom/types/payment_details_registry.proto";
import "biconom/types/locale.proto";

// Сервис для получения информации о текущем авторизованном пользователе.
service UserService {
    // Получает полную информацию о состоянии безопасности и настройках текущего пользователя.
    rpc Get(google.protobuf.Empty) returns (UserView);
}

// UserView представляет собой расширенное представление данных о пользователе.
message UserView {
    // Информация об электронной почте пользователя.
    message Email {
        optional string value = 1; // Email адрес.
        optional google.protobuf.Timestamp set_at = 2; // Дата установки email.
    }

    // Информация о пароле пользователя.
    message Password {
        bool is_set = 1; // Установлен ли пароль.
        optional google.protobuf.Timestamp set_at = 2; // Дата последней смены пароля.
    }

    Email email = 1; // Информация о почте.
    Password password = 2; // Информация о пароле.
    uint32 locale_id = 3; // Текущая локаль.
    biconom.types.GoogleAuthenticator google_authenticator = 4; // Состояние 2FA.
    biconom.types.PaymentDetailsRegistry payment_details_registry = 5; // Реестр платежных реквизитов.
}
//TOOD: отобразить политику паролей