syntax = "proto3";

package biconom.types;

import "google/protobuf/timestamp.proto";
import "google/protobuf/any.proto";
import "biconom/types/confirmation.proto";
import "biconom/types/google_authenticator_policy.proto";

// GoogleAuthenticator представляет собой настройки двухфакторной аутентификации (2FA) для пользователя.
// Эта модель НЕ содержит секретный ключ из соображений безопасности.
message GoogleAuthenticator {
	message List {
		repeated GoogleAuthenticator items = 1;
	}

	uint32 user_id = 1;	        			            	// ID пользователя, для которого настроен 2FA
	bool enabled = 2;		                			    // Текущий статус настройки 2FA
	optional biconom.types.Confirmation confirmation = 3;	// Текущее состояние запроса на изменение настроек 2FA
	
	uint64 trace_id = 4;		                    		// Уникальный идентификатор операции, в рамках которой был создан объект
	uint32 policy_id = 5;			                    	// Политика, управляющая правилами 2FA
	google.protobuf.Timestamp created_at = 6;
	google.protobuf.Timestamp updated_at = 7;
	optional google.protobuf.Any additional_data = 8;
}
