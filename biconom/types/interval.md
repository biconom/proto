# Модель: Interval

## 1. Описание

**`Interval`** — это универсальная встраиваемая модель, предназначенная для определения временных интервалов (таймфреймов) и связанных с ними параметров, таких как смещение часового пояса. Она используется в различных сервисах для запроса данных, агрегированных по времени, например, при построении графиков или аналитических отчетов.

## 2. Назначение и решаемые задачи

Основная цель модели — предоставить стандартизированный способ указания временного разрешения для агрегации данных.

### Ключевые задачи:
- **Унификация**: Определяет единый набор поддерживаемых временных интервалов (`MINUTE`, `HOUR`, `DAY` и т.д.), что обеспечивает консистентность во всем API.
- **Корректность агрегации**: Позволяет передавать смещение часового пояса (`timezone_offset_seconds`), что критически важно для правильной группировки данных по дневным, недельным и месячным интервалам. Без этого параметра "начало дня" всегда будет считаться по UTC, что приведет к неверному отображению данных для пользователей в других часовых поясах.
- **Переиспользуемость**: Является независимой и может быть встроена в любой запрос, где требуется указание временного интервала.

## 3. Ключевые поля и концепции

- `enum Id`: Перечисление всех поддерживаемых системой временных интервалов.
  - `MINUTE`, `HOUR`, `DAY`, `WEEK_MONDAY_START`, `WEEK_SUNDAY_START`, `WEEK_SATURDAY_START`, `MONTH`, `YEAR`.
- `id`: Поле, в котором передается выбранный тип интервала из `enum Id`.
- `timezone_offset_seconds`: Смещение часового пояса клиента в секундах относительно UTC.
  - **Пример**: Для часового пояса `UTC+3` значение будет `10800`. Для `UTC-5` — `-18000`.
  - **Важность**: Это поле позволяет бэкенду правильно определять границы дней, недель и месяцев в локальном времени пользователя.

## 4. Сценарии использования

- **Запрос часового графика**: Клиент формирует запрос на получение данных для графика и вкладывает в него объект `Interval` со значениями:
  - `id: HOUR`
  - `timezone_offset_seconds: 0` (или смещение пользователя, хотя для часовых интервалов это менее критично).
- **Запрос дневного графика для пользователя в Дубае (UTC+4)**: Клиент определяет смещение пользователя и формирует объект `Interval`:
  - `id: DAY`
  - `timezone_offset_seconds: 14400`
  Бэкенд, получив этот запрос, будет агрегировать данные так, чтобы каждая "свеча" графика начиналась и заканчивалась в полночь по времени Дубая, а не по UTC.

## 5. Связи с другими моделями

- **`Chart`**: Модель `Interval` может быть встроена в запрос на получение данных для графика, чтобы указать таймфрейм свечей.
- **Аналитические сервисы**: Любой сервис, возвращающий данные, сгруппированные по времени, может использовать `Interval` в качестве параметра запроса.