# Модель: Price

## 1. Описание

**`Price`** — это универсальная встраиваемая модель, предназначенная для представления денежных значений в системе. Она объединяет идентификатор валюты и саму сумму, обеспечивая консистентность финансовых данных во всех API.

## 2. Назначение и решаемые задачи

Основная цель модели — предоставить надежный стандарт для работы с финансами.

### Ключевые задачи:
- **Высокая точность**: Использование строкового типа (`string`) для поля `amount` позволяет передавать десятичные числа (decimal) любой точности без потерь, которые неизбежны при использовании `float` или `double`.
- **Унификация**: Все сервисы (торговля, маркетинг, кошельки) используют одну и ту же структуру для отображения цен, комиссий и доходов.
- **Мультивалютность**: Каждое денежное значение жестко привязано к конкретной валюте через `currency_id`.

## 3. Ключевые поля и концепции

- **`currency_id`**: Уникальный идентификатор валюты из справочника `Currency`. Позволяет системе понять, в каких единицах измерения указана сумма (например, USDT, BTC, USD).
- **`amount`**: Строковое представление числового значения. 
  - **Важно**: Всегда передается как строка (например, `"100.05000000"`), чтобы избежать проблем с точностью на стороне различных языков программирования и при сериализации в JSON.
- **`List`**: Вложенное сообщение-обертка, используемое в методах, которые возвращают массив цен (например, список доходов в разных валютах).

## 4. Сценарии использования

- **Отображение стоимости**: В `TariffPlan` модель используется для указания цены подписки.
- **Расчет комиссий**: В методах `GetAddWidthCost` или `GetManualPlacementCost` сервис возвращает объект `Price`, чтобы клиент знал точную сумму и валюту списания.
- **Аналитика доходов**: В маркетинговых ветках (`Branch`) доход каждой ветки фиксируется через модель `Price`, что позволяет корректно суммировать прибыль по разным бонусным программам.

## 5. Связи с другими моделями

- **`Currency`**: Поле `currency_id` является внешним ключом к этой модели.
- **`TariffPlan`**: Использует `Price` для определения стоимости услуг.
- **`MarketingService`**: Активно использует `Price` для всех расчетов, связанных с покупкой слотов, расширением структуры и начислением бонусов.
- **`Chart`**: В монетарных графиках данные свечей логически соответствуют структуре `Price`.

## 6. Рекомендации по обработке

### На стороне клиента (Frontend/Mobile):
Рекомендуется использовать специализированные библиотеки для работы с BigNumber (например, `bignumber.js` для JS или `Decimal` для Swift/Kotlin) при получении значения из поля `amount`. Никогда не преобразуйте это поле в стандартный тип `Number` или `Double`, если планируете выполнять с ним арифметические операции.

### На стороне сервера:
При получении `Price` из запроса, значение `amount` должно парситься непосредственно в тип данных `Decimal` (или аналогичный тип с фиксированной запятой) для проведения расчетов в базе данных или финансовом ядре.
