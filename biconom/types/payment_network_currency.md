# Модель: PaymentNetworkCurrency

## 1. Описание

**`PaymentNetworkCurrency`** — это ключевая связующая модель, которая определяет, что конкретная платежная сеть (`PaymentNetwork`) поддерживает определенную валюту (`Currency`). Она также содержит все необходимые настройки для операций ввода (`deposit`) и вывода (`withdraw`) этой валюты в данной платежной сети.

Логическим ключом является пара (`payment_network_id`, `currency_id`).

## 2. Назначение и решаемые задачи

Основная цель — централизованно хранить и управлять всеми правилами и лимитами для каждой пары "платежная сеть-валюта".

### Ключевые задачи:
- **Создание связи**: Декларирует, что, например, валюта USDT (`currency_id`) доступна для операций в платежной сети Tron (`payment_network_id`).
- **Управление доступностью**: Поле `status` позволяет гибко управлять доступностью валюты в платежной сети (например, временно отключить на `MAINTENANCE`).
- **Конфигурация операций**: Содержит отдельные объекты настроек `deposit_settings` и `withdraw_settings` для независимого управления вводом и выводом. Это позволяет, например, разрешить депозиты, но временно отключить выводы.

## 3. Ключевые поля и концепции

- `payment_network_id`: ID платежной сети.
- `currency_id`: ID валюты.
- `status`: Операционный статус связки "платежная сеть-валюта" (`ACTIVE`, `INACTIVE`, `MAINTENANCE`, `RETIRED`). Не зависит от статуса самой платежной сети или валюты.
- `deposit_settings`: Экземпляр модели `PaymentOperationSettings`, содержащий все правила для операций пополнения (лимиты, комиссии, доступность).
- `withdraw_settings`: Экземпляр модели `PaymentOperationSettings`, содержащий все правила для операций вывода.
- `created_at`: Время создания записи о связке.
- `updated_at`: Время последнего обновления записи.

## 4. Сценарии использования

- **Настройка USDT в платежной сети Ethereum**: Администратор создает запись `PaymentNetworkCurrency` с `payment_network_id` для Ethereum и `currency_id` для USDT. В `deposit_settings` он устанавливает минимальную сумму депозита и комиссии. В `withdraw_settings` он устанавливает лимиты на вывод и включает операцию (`enabled = true`).
- **Временное отключение выводов**: Если в платежной сети Ethereum высокая нагрузка и дорогие комиссии, администратор может обновить `withdraw_settings.enabled` на `false`, не затрагивая при этом возможность пополнения счета.

## 5. Связи с другими моделями

- **`PaymentNetwork`**: `PaymentNetworkCurrency` **ссылается** на `PaymentNetwork` через поле `payment_network_id`.
- **`Currency`**: `PaymentNetworkCurrency` **ссылается** на `Currency` через поле `currency_id`.
- **`PaymentOperationSettings`**: `PaymentNetworkCurrency` **встраивает** два экземпляра этой модели в поля `deposit_settings` и `withdraw_settings` для детальной настройки операций.
