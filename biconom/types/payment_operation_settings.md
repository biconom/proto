# Модель: PaymentOperationSettings

## 1. Описание

**`PaymentOperationSettings`** — это универсальная, встраиваемая модель, которая описывает полный набор правил для одной конкретной операции, будь то пополнение (`deposit`) или вывод (`withdraw`).

Она используется как составная часть в моделях `PaymentNetworkCurrency`.

## 2. Назначение и решаемые задачи

Основная цель — инкапсулировать всю бизнес-логику, связанную с лимитами, комиссиями и доступностью операций, в одном переиспользуемом блоке.

### Ключевые задачи:
- **Управление доступностью**: Поле `enabled` служит простым "рубильником" для включения или отключения операции.
- **Управление лимитами**: Поля `min_amount` и `max_amount` задают диапазон допустимых сумм для операции.
- **Гибкая обработка исключений**: `OutOfRangePolicy` (`below_min_policy`, `above_max_policy`) определяет, как система должна реагировать на суммы, выходящие за рамки лимитов (отклонить, удержать для ручной обработки и т.д.).
- **Расчет комиссий**: Поле `fee` ссылается на `CalculationGroup`, позволяя определять сложные, многокомпонентные комиссии.
- **Детализация для платежной сети**: Поле `network_settings` опционально содержит технические параметры, специфичные для конкретной платежной сети (например, количество подтверждений для блокчейна).

## 3. Ключевые поля и концепции

- `enabled`: Глобальный флаг, разрешающий или запрещающий операцию.
- `min_amount` / `max_amount`: Строковые поля для сумм, чтобы избежать проблем с точностью `float`/`double`. `optional` означает, что лимит может отсутствовать.
- `below_min_policy` / `above_max_policy`: Политики, которые применяются, если сумма операции меньше минимальной или больше максимальной соответственно.
- `fee`: Ссылка на `CalculationGroup` для расчета комиссий.
- `network_settings`: Ссылка на `PaymentNetworkOperationSettings`, содержащая технические детали, необходимые для взаимодействия с платежной сетью (например, для блокчейна).

## 4. Сценарии использования

- **Настройка вывода BTC**: В `withdraw_settings` для пары (Bitcoin, BTC) можно установить `min_amount = "0.001"`, `enabled = true`, а в `fee` указать `CalculationGroup` с фиксированной комиссией. В `network_settings` будут указаны параметры, специфичные для платежной сети Bitcoin.
- **Обработка "пылевых" депозитов**: Для депозитов можно установить `below_min_policy = REJECT`, чтобы система автоматически отклоняла слишком маленькие суммы, которые невыгодно обрабатывать.

## 5. Связи с другими моделями

- **`PaymentNetworkCurrency`**: **Встраивает** два экземпляра `PaymentOperationSettings` в поля `deposit_settings` и `withdraw_settings`.
- **`PaymentNetworkOperationSettings`**: `PaymentOperationSettings` **опционально встраивает** эту модель для хранения специфичных для платежной сети технических параметров.
- **`CalculationGroup`**: `PaymentOperationSettings` **встраивает** эту модель для описания правил расчета комиссий.
