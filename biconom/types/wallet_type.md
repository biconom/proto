# Модель: WalletType

## 1. Описание

**`WalletType`** — это справочная модель, которая определяет тип или "шаблон" кошелька (например, "Спотовый", "Маржинальный", "Бонусный"). Она служит для группировки кошельков по их назначению и для централизованного управления их базовыми правилами и возможностями.

## 2. Назначение и решаемые задачи

Основная цель модели — создать гибкую систему, позволяющую администраторам определять различные виды кошельков с уникальным набором разрешенных операций, не изменяя код.

### Ключевые задачи:
- **Каталогизация**: Предоставляет уникальные идентификаторы (`id`, `code`) для каждого типа кошелька.
- **Управление жизненным циклом**: Поле `status` позволяет управлять доступностью целых типов кошельков (например, временно перевести в режим `MAINTENANCE`).
- **Декларация возможностей**: Поле `allowed_operations_flags` определяет, какие операции в принципе разрешены для кошельков данного типа. Это "белый список" базовых возможностей.

## 3. Ключевые поля и концепции

- `id`, `code`, `name`, `description`: Стандартные поля для идентификации и описания. `code` используется как стабильный строковый идентификатор в коде.
- `status`: Операционный статус типа кошелька (`ACTIVE`, `MAINTENANCE`, `RETIRED`).
- `allowed_operations_flags`: **Ключевое поле**. Это битовая маска, которая определяет, какие операции разрешены для всех кошельков этого типа. Позиции битов в маске соответствуют значениям из перечисления `WalletOperation.Id`.

## 4. Сценарии использования

- **Создание "Спотового" кошелька**: Администратор создает `WalletType` с `code="SPOT"`. В `allowed_operations_flags` он устанавливает биты, соответствующие `DEPOSIT`, `WITHDRAW`, `INTERNAL_TRANSFER_SEND`, `INTERNAL_TRANSFER_RECEIVE` и `PAYMENT`.
- **Создание "Бонусного" кошелька**: Создается `WalletType` с `code="BONUS"`. В `allowed_operations_flags` устанавливаются только биты для `INTERNAL_TRANSFER_SEND` (чтобы можно было перевести бонусы на основной кошелек) и `PAYMENT` (чтобы можно было оплатить услуги бонусами), но не для `WITHDRAW`.

## 5. Связи с другими моделями

- **`Wallet`**: Каждый экземпляр `Wallet` **создается на основе** `WalletType` и ссылается на него через поле `wallet_type_id`.
- **`WalletTypeCurrency`**: `WalletType` **является родительской сущностью** для связей `WalletTypeCurrency`, которые определяют, какие валюты доступны в данном типе кошелька и какие для них действуют исключения.
- **`WalletOperation`**: `WalletType` **логически использует** перечисление `WalletOperation.Id` для определения позиций битов в поле `allowed_operations_flags`.